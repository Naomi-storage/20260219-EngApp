<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>English Flashcard Master - Full Version</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üéì</text></svg>">
    <style>
        :root {
            --primary-color: #2c3e50;
            --accent-color: #3498db;
            --success-color: #27ae60;
            --error-color: #e74c3c;
            --bg-color: #f0f2f5;
            --card-bg: #ffffff;
            --text-main: #2c3e50;
        }

        * {
            box-sizing: border-box;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
            touch-action: manipulation;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: 'Helvetica Neue', Arial, 'Hiragino Kaku Gothic ProN', 'Hiragino Sans', Meiryo, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }

        #app-container {
            width: 95%;
            max-width: 450px;
            height: 90vh;
            background: var(--card-bg);
            border-radius: 24px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
        }

        header {
            background: var(--primary-color);
            color: white;
            padding: 18px;
            text-align: center;
            font-weight: bold;
            font-size: 1.1rem;
            letter-spacing: 0.05em;
        }

        .stats-bar {
            display: flex;
            justify-content: space-around;
            background: #ecf0f1;
            padding: 8px;
            font-size: 0.85rem;
            border-bottom: 1px solid #ddd;
        }

        #game-screen {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            padding: 20px;
            justify-content: space-between;
            align-items: center;
            overflow-y: auto;
        }

        .question-card {
            width: 100%;
            min-height: 280px;
            margin-bottom: 15px;
            background: #fff;
            border: 2px solid #e0e0e0;
            border-radius: 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 25px;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }

        #japanese-text {
            font-size: 1.05rem;
            color: #7f8c8d;
            margin-bottom: 15px;
            line-height: 1.5;
        }

        #english-text {
            color: var(--accent-color);
            font-size: 1.25rem;
            font-weight: bold;
            line-height: 1.4;
            display: none;
            word-wrap: break-word;
            margin-bottom: 15px;
        }

        #explanation-box {
            display: none;
            width: 100%;
            background: #f8f9fa;
            border-radius: 12px;
            padding: 15px;
            text-align: left;
            font-size: 0.85rem;
            color: #34495e;
            border-left: 4px solid var(--accent-color);
            margin-top: 10px;
        }

        .explanation-title {
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 5px;
            display: block;
        }

        .controls {
            width: 100%;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        .btn {
            padding: 16px;
            border: none;
            border-radius: 12px;
            font-weight: bold;
            font-size: 0.95rem;
            cursor: pointer;
            color: white;
            transition: opacity 0.2s;
        }

        .btn:active { opacity: 0.7; }

        .btn-correct { background-color: var(--success-color); }
        .btn-wrong { background-color: var(--error-color); }
        .btn-next { background-color: var(--primary-color); grid-column: span 2; display: none; }
        .btn-finish { background-color: #bdc3c7; grid-column: span 2; margin-top: 5px; color: #2c3e50; }

        #start-overlay {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: var(--primary-color);
            color: white;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
            padding: 20px;
        }

        .category-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
            width: 100%;
            margin-top: 20px;
            overflow-y: auto;
            max-height: 60vh;
        }

        .category-btn {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.3);
            color: white;
            padding: 15px;
            border-radius: 10px;
            text-align: left;
            font-size: 0.9rem;
            cursor: pointer;
        }

        #result-screen {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: white;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 40px;
            text-align: center;
            z-index: 110;
        }

        .result-score { font-size: 4rem; color: var(--accent-color); font-weight: 800; margin: 10px 0; }
    </style>
</head>
<body>

<div id="app-container">
    <div id="start-overlay">
        <h1 style="margin-bottom: 5px; font-size: 1.5rem;">English Advanced Full</h1>
        <p style="opacity: 0.8; margin-bottom: 20px; font-size: 0.9rem;">Â≠¶Áøí„Ç´„ÉÜ„Ç¥„É™„ÇíÈÅ∏ÊäûÔºàÂÖ®60Âïè‰ª•‰∏äÔºâ</p>
        <div class="category-grid">
            <button class="category-btn" onclick="startGame('business')">üíº ËÅ∑Â†¥„ÅÆ‰ºöË©± (15Âïè)</button>
            <button class="category-btn" onclick="startGame('meeting')">üåê Web‰ºöË≠∞ (15Âïè)</button>
            <button class="category-btn" onclick="startGame('daily')">üè† Êó•Â∏∏ÁîüÊ¥ª (15Âïè)</button>
            <button class="category-btn" onclick="startGame('news')">üìà ÊôÇ‰∫ãÂïèÈ°å (20Âïè)</button>
        </div>
    </div>

    <header id="current-category-name">English Master</header>
    
    <div class="stats-bar">
        <span>Êú™ÂÆå‰∫Ü: <span id="stat-remaining">0</span></span>
        <span>Ê≠£Ëß£Êï∞: <span id="stat-correct">0</span></span>
    </div>

    <div id="game-screen">
        <div class="question-card" id="card" onclick="showAnswer()">
            <div id="japanese-text">Ë™≠„ÅøËæº„Åø‰∏≠...</div>
            <div id="english-text"></div>
            <div id="explanation-box">
                <span class="explanation-title">üí° Idioms & Tips</span>
                <div id="explanation-content"></div>
            </div>
        </div>

        <div class="controls" id="game-controls">
            <button class="btn btn-correct" id="btn-correct" onclick="judge(true)" style="display: none;">Ë¶ö„Åà„Åü</button>
            <button class="btn btn-wrong" id="btn-wrong" onclick="judge(false)" style="display: none;">„Åæ„ÅüÂá∫„Åô</button>
            <button class="btn btn-next" id="btn-next" onclick="nextQuestion()">Ê¨°„Å∏ÈÄ≤„ÇÄ</button>
            <button class="btn btn-finish" id="btn-finish" onclick="finishGame()">ÁµÇ‰∫Ü</button>
        </div>
    </div>

    <div id="result-screen">
        <h2>Performance</h2>
        <div class="result-score" id="final-rate">0%</div>
        <p id="final-stats" style="color: #7f8c8d;"></p>
        <button class="btn" style="background: var(--primary-color); width: 100%; margin-top: 30px;" onclick="location.reload()">„Çø„Ç§„Éà„É´„Å´Êàª„Çã</button>
    </div>
</div>

<script>
    const questionBank = {
        business: [
            { jp: "„ÅäÂøô„Åó„ÅÑ„Å®„Åì„ÇçÊÅêÁ∏Æ„Åß„Åô„Åå„ÄÅÈÄ≤Êçó„Çí‰º∫„Åà„Åæ„Åô„ÅãÔºü", en: "I'm sorry to bother you, but could you give me an update on the progress?", ex: "I'm sorry to bother you „ÅØÁõÆ‰∏ä„ÅÆ‰∫∫„ÇÑÂøô„Åó„ÅÑÁõ∏Êâã„Å∏„ÅÆ„ÇØ„ÉÉ„Ç∑„Éß„É≥Ë®ÄËëâ„ÄÇ" },
            { jp: "„Åù„ÅÆ‰ª∂„Å´„Å§„Åç„Åæ„Åó„Å¶„ÅØ„ÄÅÊîπ„ÇÅ„Å¶Ê§úË®é„Åï„Åõ„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ", en: "Please let me take that under advisement and get back to you.", ex: "take under advisement „ÅØ„ÄåÊÖéÈáç„Å´Ê§úË®é„Åô„Çã„Äç„Å®„ÅÑ„ÅÜ„Éï„Ç©„Éº„Éû„É´„Å™Ë°®Áèæ„ÄÇ" },
            { jp: "Ëµ∑Ê•≠ÂÆ∂„Å®„Åó„Å¶ÊàêÂäü„Åô„Çã„Åü„ÇÅ„Å´„ÅØ„ÄÅÊó¢Â≠ò„ÅÆÊû†„Å´„Å®„Çâ„Çè„Çå„Åö„Å´ËÄÉ„Åà„Çã„Åì„Å®„ÅåÊ±Ç„ÇÅ„Çâ„Çå„Çã„ÄÇ", en: "Being a successful entrepreneur requires you to think outside the box.", ex: "think outside the box „ÅØ„ÄåÊñ¨Êñ∞„Å™Áô∫ÊÉ≥„Çí„Åô„Çã„Äç„Å®„ÅÑ„ÅÜÈáçË¶Å„Ç§„Éá„Ç£„Ç™„É†„ÄÇ" },
            { jp: "„Åì„ÅÆ„Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÇíÊàêÂäü„Åï„Åõ„Çã„Åü„ÇÅ„Å´Áü•ÊÅµ„ÇíÂá∫„ÅóÂêà„ÅÑ„Åæ„Åó„Çá„ÅÜ„ÄÇ", en: "Let's put our heads together to make this project a success.", ex: "put our heads together „Åß„ÄåÂçîÂäõ„Åó„Å¶ËÄÉ„Åà„Çã„Äç„ÄÇ" },
            { jp: "ÂΩº„ÅØ„Åù„ÅÆÂèñÂºï„Çí„Åæ„Å®„ÇÅ„Çã„Åü„ÇÅ„Å´„ÄÅÂÖ®Âäõ„ÇíÂ∞Ω„Åè„Åó„Åæ„Åó„Åü„ÄÇ", en: "He went the extra mile to close the deal.", ex: "go the extra mile „ÅØ„ÄåÊúüÂæÖ‰ª•‰∏ä„ÅÆÂä™Âäõ„Çí„Åô„Çã„Äç„ÄÇ" },
            { jp: "ÊÆãÂøµ„Å™„Åå„Çâ„ÄÅ„Åì„ÅÆÊèêÊ°à„ÅØ‰ªä„ÅÆ„Å®„Åì„Çç‰øùÁïô„Å´„Åô„ÇãÂøÖË¶Å„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ", en: "Unfortunately, we need to put this proposal on the back burner for now.", ex: "put on the back burner „ÅØ„ÄåÂæåÂõû„Åó„Å´„Åô„Çã„Äç„ÄÇ" },
            { jp: "ÂΩº„ÅØÂ∏∏„Å´Âë®Âõ≤„ÅÆÊúüÂæÖ‰ª•‰∏ä„ÅÆÊàêÊûú„ÇíÂá∫„Åù„ÅÜ„Å®Âä™„ÇÅ„Å¶„ÅÑ„Åæ„Åô„ÄÇ", en: "He always strives to exceed everyone's expectations.", ex: "strive to „ÅØ„Äå„Äú„Åó„Çà„ÅÜ„Å®Êá∏ÂëΩ„Å´Âä™Âäõ„Åô„Çã„Äç„ÄÇ" },
            { jp: "Á∑†„ÇÅÂàá„Çä„Å´Èñì„Å´Âêà„Çè„Åõ„Çã„Åü„ÇÅ„Å´„ÄÅÊÄ•„ÅêÂøÖË¶Å„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ", en: "We need to step it up to meet the deadline.", ex: "step it up „ÅØ„Äå„Éî„ÉÉ„ÉÅ„Çí‰∏ä„Åí„Çã„Äç„ÄåÂä™Âäõ„ÇíÂº∑Âåñ„Åô„Çã„Äç„ÄÇ" },
            { jp: "„Åì„Çå„Åæ„Åß„ÅÆÈÄ≤Êçó„Çí„Åñ„Å£„Å®Ë™¨Êòé„Åó„Å¶„ÅÑ„Åü„Å†„Åë„Åæ„Åô„ÅãÔºü", en: "Could you give me a brief rundown of the progress so far?", ex: "rundown „ÅØ„ÄåÊ¶ÇË¶ÅÂ†±Âëä„Äç„ÅÆ„Åì„Å®„ÄÇ" },
            { jp: "ÂΩº„ÅØÈùûÂ∏∏„Å´Ë≤¨‰ªªÊÑü„ÅÆÂº∑„ÅÑ„ÉÅ„Éº„É†„Éó„É¨„Ç§„É§„Éº„Åß„Åô„ÄÇ", en: "He is a highly accountable team player.", ex: "accountable „ÅØ„ÄåË≤¨‰ªª„Åå„ÅÇ„Çã„ÄÅË™¨ÊòéË≤¨‰ªª„ÇíÊûú„Åü„Åô„Äç„ÄÇ" },
            { jp: "Ë©≥Á¥∞„ÅåÂàÜ„Åã„ÇäÊ¨°Á¨¨„ÄÅ„Åô„Åê„Å´„ÅîÈÄ£Áµ°„ÅÑ„Åü„Åó„Åæ„Åô„ÄÇ", en: "I'll let you know as soon as more details become available.", ex: "Details become available „Åß„ÄåË©≥Á¥∞„ÅåÂà§Êòé„Åô„Çã„Äç„ÄÇ" },
            { jp: "„Åù„Çå„ÅØÁßÅ„Åü„Å°„Åå‰ªäÈõÜ‰∏≠„Åô„Åπ„Åç„Åì„Å®„Åß„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ", en: "That is not something we should be focusing on right now.", ex: "Focus on „Åß„Äå„Äú„Å´ÈõÜ‰∏≠„Åô„Çã„Äç„ÄÇ" },
            { jp: "ÂΩº„ÅÆÊòáÈÄ≤„ÅØÂΩìÁÑ∂„ÅÆÁµêÊûú„Å†„Å®Ë®Ä„Åà„Åæ„Åô„ÄÇ", en: "It's safe to say that his promotion was well-deserved.", ex: "well-deserved „ÅØ„ÄåÂèó„Åë„Çã„Å´ÂÄ§„Åô„Çã„Äç„ÄÇ" },
            { jp: "„Åù„ÅÆÊèêÊ°à„ÅØ„Ç≥„Çπ„Éà„ÅÆÈù¢„ÅßÁèæÂÆüÁöÑ„Åß„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ", en: "The proposal is not feasible in terms of cost.", ex: "feasible „ÅØ„ÄåÂÆüË°åÂèØËÉΩ„Å™„Äç„ÄÇ" },
            { jp: "„Åæ„Åö„ÅØÂÖ±ÈÄö„ÅÆË™çË≠ò„ÇíÊåÅ„Å§„Åì„Å®„ÅåÈáçË¶Å„Åß„Åô„ÄÇ", en: "First, it's important that we're all on the same page.", ex: "on the same page „Åß„ÄåÂÖ±ÈÄöË™çË≠ò„ÇíÊåÅ„Å£„Å¶„ÅÑ„Çã„Äç„ÄÇ" }
        ],
        meeting: [
            { jp: "ÈõªÊ≥¢„ÅÆÁä∂Ê≥Å„ÅåÊÇ™„Åè„ÄÅÈü≥Â£∞„ÅåÈÄîÂàá„Çå„Å¶„Åó„Åæ„ÅÑ„Åæ„Åó„Åü„ÄÇ", en: "The connection was unstable and your audio cut out.", ex: "cut out „ÅØ„ÄåÈü≥„ÅåÈÄîÂàá„Çå„Çã„Äç„ÄÇ" },
            { jp: "ÊåÅ„Å°Â∏∞„Å£„Å¶Ê§úË®é„Åó„ÄÅÊòéÊó•„ÅäËøî‰∫ã„Åó„Åæ„Åô„ÄÇ", en: "I'll take that back, look into it, and get back to you tomorrow.", ex: "take back „ÅØ„ÄåÁ§æÂÜÖ„Å´ÊåÅ„Å°Â∏∞„Çã„Äç„ÄÇ" },
            { jp: "Êú¨È°å„Å´ÂÖ•„ÇãÂâç„Å´„ÄÅ„Åæ„Åö„ÅØËá™Â∑±Á¥π‰ªã„Çí„Åó„Åæ„Åó„Çá„ÅÜ„ÄÇ", en: "Before we dive in, let's start with a round of introductions.", ex: "dive in „ÅØ„ÄåË≠∞Ë´ñ„Å´Ê∑±„ÅèÂÖ•„Çã„Äç„ÄÇ" },
            { jp: "ÁµêË´ñ„ÇíË®Ä„Åà„Å∞„ÄÅ‰∫àÁÆó„Çí20%ÂâäÊ∏õ„Åô„ÇãÂøÖË¶Å„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ", en: "The bottom line is that we need to cut the budget by 20%.", ex: "The bottom line is „ÅØ„ÄåË¶Å„Åô„Çã„Å´„Äç„ÄÇ" },
            { jp: "‰ªä„ÅÆÁô∫Ë®Ä„Çí„ÇÇ„ÅÜ‰∏ÄÂ∫¶Ë©≥„Åó„ÅèË™¨Êòé„Åó„Å¶„ÅÑ„Åü„Å†„Åë„Åæ„Åô„ÅãÔºü", en: "Could you elaborate on what you just said?", ex: "elaborate „ÅØ„ÄåË©≥Á¥∞„ÇíËø∞„Åπ„Çã„Äç„ÄÇ" },
            { jp: "ÁîªÈù¢„ÇíÂÖ±Êúâ„Åó„Åæ„Åô„ÅÆ„Åß„ÄÅÂ∞ë„ÄÖ„ÅäÂæÖ„Å°„Åè„Å†„Åï„ÅÑ„ÄÇ", en: "I'm going to share my screen, so please bear with me for a moment.", ex: "bear with me „ÅØ„ÄåÂ∞ë„ÄÖ„ÅäÂæÖ„Å°„Åè„Å†„Åï„ÅÑÔºàÊàëÊÖ¢„Åó„Å¶„Åè„Å†„Åï„ÅÑÔºâ„Äç„ÄÇ" },
            { jp: "„Åô„Åø„Åæ„Åõ„Çì„ÄÅÈÄî‰∏≠„ÅßÂè£„ÇíÊåü„Çì„Åß„ÇÇ„Çà„Çç„Åó„ÅÑ„Åß„Åó„Çá„ÅÜ„ÅãÔºü", en: "Sorry, may I jump in for a second?", ex: "jump in „Åß„Äå‰ºöË©±„Å´Âä†„Çè„Çã/Ââ≤„ÇäËæº„ÇÄ„Äç„ÄÇ" },
            { jp: "„ÅÇ„Å™„Åü„Åå„Éü„É•„Éº„Éà„Å´„Å™„Å£„Å¶„ÅÑ„Çã„Çà„ÅÜ„Åß„Åô„ÄÇ", en: "I think you're on mute.", ex: "ÂÆöÁï™„ÅÆ„Äå„Éü„É•„Éº„Éà„Åß„Åô„Çà„Äç„ÄÇ" },
            { jp: "„ÉÅ„É£„ÉÉ„ÉàÊ¨Ñ„Å´„É™„É≥„ÇØ„ÇíË≤º„Çä„Åæ„Åó„Åü„ÄÇ", en: "I've posted the link in the chat box.", ex: "post in the chat box „Åß„Äå„ÉÅ„É£„ÉÉ„Éà„Å´ÊäïÁ®ø„Åô„Çã„Äç„ÄÇ" },
            { jp: "„ÇÇ„ÅÜ‰∏ÄÂ∫¶Ë®Ä„Å£„Å¶„ÅÑ„Åü„Å†„ÅÑ„Å¶„ÇÇ„ÅÑ„ÅÑ„Åß„Åô„ÅãÔºü", en: "Could you say that again? You're breaking up.", ex: "breaking up „ÇÇ„ÄåÈü≥Â£∞„ÅåÈÄîÂàá„Çå„Å¶„ÅÑ„Çã„ÄçÊôÇ„Å´‰Ωø„ÅÜ„ÄÇ" },
            { jp: "‰ªäÊó•„ÅÆË≠∞È°å„ÅØ3„Å§„ÅÇ„Çä„Åæ„Åô„ÄÇ", en: "We have three items on the agenda today.", ex: "on the agenda „Åß„ÄåË≠∞È°å„Å´‰∏ä„Åå„Å£„Å¶„Äç„ÄÇ" },
            { jp: "ÊôÇÈñì„ÇíÂÆà„Çã„Åü„ÇÅ„Å´Ê¨°„Å´ÈÄ≤„Åø„Åæ„Åó„Çá„ÅÜ„ÄÇ", en: "In the interest of time, let's move on to the next topic.", ex: "In the interest of time „ÅØ„ÄåÊôÇÈñì„ÇíÁØÄÁ¥Ñ„Åô„Çã„Åü„ÇÅ„Å´„Äç„ÄÇ" },
            { jp: "„Åù„Çå„Å´„Å§„ÅÑ„Å¶„ÅØÂæå„ÅßË©≥„Åó„Åè„É°„Éº„É´„Åó„Åæ„Åô„ÄÇ", en: "I'll follow up with an email regarding that later.", ex: "follow up „ÅØ„ÄåÂæåËøΩ„ÅÑ„Çí„Åô„Çã/Ë©≥Á¥∞„ÇíËøΩ„ÅÜ„Äç„ÄÇ" },
            { jp: "Ë™∞„ÅãÊÑèË¶ã„ÇÑË≥™Âïè„ÅØ„ÅÇ„Çä„Åæ„Åô„ÅãÔºü", en: "Does anyone have any input or questions?", ex: "input „ÅØ„ÄåÊÑèË¶ã/Âä©Ë®Ä„Äç„ÅÆÊÑèÂë≥„Åß„Çà„Åè‰Ωø„ÅÜ„ÄÇ" },
            { jp: "„Åù„Çç„Åù„ÇçÊôÇÈñì„Åß„Åô„ÅÆ„Åß„ÄÅ„Åì„Åì„ÅßÂàá„Çä‰∏ä„Åí„Åæ„Åó„Çá„ÅÜ„ÄÇ", en: "It's about time, so let's wrap it up here.", ex: "wrap up „ÅØ„ÄåÁµÇ„Åà„Çã/„Åæ„Å®„ÇÅ„Çã„Äç„ÄÇ" }
        ],
        daily: [
            { jp: "È£ØÁî∞Ê©ãÈßÖ„Åã„ÇâÊù±‰∫¨ÈßÖ„ÅØ„ÄÅ‰∏≠Â§ÆÁ∑ö„Å´‰πó„ÇäÊèõ„Åà„Åæ„Åô„ÄÇ", en: "To get to Tokyo Station, transfer to the Chuo Line.", ex: "transfer to „ÅØ„Äå‰πó„ÇäÊèõ„Åà„Çã„Äç„ÄÇ" },
            { jp: "‰∫∫„ÅØÁóÖÊ∞ó„Å´„Å™„Çã„Åæ„ÅßÂÅ•Â∫∑„ÇíÂΩì„Åü„ÇäÂâç„Å†„Å®ÊÄù„Å£„Å¶„ÅÑ„Çã„ÄÇ", en: "People take their health for granted until they get sick.", ex: "take for granted „ÅØ„ÄåÂΩì„Åü„ÇäÂâç„Å†„Å®ÊÄù„ÅÜ„Äç„ÄÇ" },
            { jp: "Êò®Êó•„ÅØ‰∏ÄÊô©‰∏≠„ÄÅÊøÄ„Åó„ÅèÈõ®„ÅåÈôç„Å£„Å¶„ÅÑ„Åæ„Åó„Åü„ÄÇ", en: "It was raining cats and dogs all night long.", ex: "raining cats and dogs „ÅØ„ÄåÂúüÁ†ÇÈôç„Çä„Äç„ÄÇ" },
            { jp: "ÂΩº„ÅØÁßÅ„ÅÆÂÜóË´á„ÇíÁúü„Å´Âèó„Åë„Å¶„ÄÅÊÄí„Å£„Å¶„Åó„Åæ„ÅÑ„Åæ„Åó„Åü„ÄÇ", en: "He took my joke to heart and got angry.", ex: "take to heart „ÅØ„ÄåÁúü„Å´Âèó„Åë„Çã„Äç„ÄÇ" },
            { jp: "‰πÖ„Åó„Å∂„Çä„Å´Âú∞ÂÖÉ„ÅÆÂèãÈÅî„Å´‰ºö„Åà„Å¶Ê•Ω„Åó„Åã„Å£„Åü„Åß„Åô„ÄÇ", en: "It was great catching up with my old friends.", ex: "catch up with „Åß„Äå‰πÖ„Åó„Å∂„Çä„Å´ËøëÊ≥Å„ÇíË©±„ÅóÂêà„ÅÜ„Äç„ÄÇ" },
            { jp: "‰ªä„ÅÆ‰ªï‰∫ã„Å´„Åô„Å£„Åã„ÇäÊÖ£„Çå„Åæ„Åó„Åü„ÅãÔºü", en: "Have you fully settled into your new job yet?", ex: "settle into „ÅØ„ÄåÈ¶¥Êüì„ÇÄ/ËêΩ„Å°ÁùÄ„Åè„Äç„ÄÇ" },
            { jp: "„ÅÇ„ÅÑ„Å´„Åè„ÄÅ„Åù„ÅÆÊó•„ÅØ‰∫àÂÆö„ÅåÂÖ•„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇ", en: "Unfortunately, I'm tied up that day.", ex: "be tied up „Åß„ÄåÂøô„Åó„Åè„Å¶Êâã„ÅåÈõ¢„Åõ„Å™„ÅÑ/‰∫àÂÆö„Åå„ÅÇ„Çã„Äç„ÄÇ" },
            { jp: "ÂΩº„ÅØÁßÅ„ÅÆÊúüÂæÖ„ÇíË£èÂàá„Å£„Åü„Åì„Å®„Åå„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ", en: "He has never let me down.", ex: "let someone down „ÅØ„Äå‰∫∫„Çí„Åå„Å£„Åã„Çä„Åï„Åõ„Çã„Äç„ÄÇ" },
            { jp: "„Å©„ÅÜ„ÅÑ„Åü„Åó„Åæ„Åó„Å¶„ÄÇ„ÅÑ„Å§„Åß„ÇÇË®Ä„Å£„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ", en: "Don't mention it. Any time.", ex: "Don't mention it „ÅØ„ÄåÁ§º„Å´„ÅØÂèä„Å∞„Å™„ÅÑ„Äç„ÄÇ" },
            { jp: "‰ªäÊó•„ÅØ‰∏ÄÊó•‰∏≠„ÄÅ‰Ωì„Åå„Å†„Çã„ÅÑ„Åß„Åô„ÄÇ", en: "I've been feeling sluggish all day today.", ex: "sluggish „ÅØ„Äå‰Ωì„ÅåÈáç„ÅÑ„ÄÅ„Å†„Çã„ÅÑ„Äç„ÄÇ" },
            { jp: "„Åù„Çå„ÅØ‰∏ÄÁü≥‰∫åÈ≥•„Åß„Åô„Å≠„ÄÇ", en: "That's killing two birds with one stone.", ex: "‰∏ÄÁü≥‰∫åÈ≥•„ÅÆÁõ¥Ë®≥„Ç§„Éá„Ç£„Ç™„É†„ÄÇ" },
            { jp: "ÂΩº„ÅØ„ÅÑ„Å§„ÇÇ‰ªñ‰∫∫„ÅÆÊÇ™Âè£„ÇíË®Ä„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇ", en: "He is always speaking ill of others.", ex: "speak ill of „Åß„Äå„Äú„ÅÆÊÇ™Âè£„ÇíË®Ä„ÅÜ„Äç„ÄÇ" },
            { jp: "‰ªä„ÅÆ„Å®„Åì„Çç„ÄÅ„Åô„Åπ„Å¶È†ÜË™ø„Åß„Åô„ÄÇ", en: "So far, so good.", ex: "„Äå‰ªä„ÅÆ„Å®„Åì„ÇçÂïèÈ°å„Å™„Åó„Äç„Å®„ÅÑ„ÅÜÊ±∫„Åæ„ÇäÊñáÂè•„ÄÇ" },
            { jp: "„Åù„ÅÆÊò†Áîª„ÅØÊú¨ÂΩì„Å´ÊÑüÂãïÁöÑ„Åß„Åó„Åü„ÄÇ", en: "That movie was truly touching.", ex: "touching „ÅØ„ÄåÔºàÂøÉ„Å´Ëß¶„Çå„Çã„Çà„ÅÜ„Å™ÔºâÊÑüÂãïÁöÑ„Å™„Äç„ÄÇ" },
            { jp: "„ÅäÂêçÂâç„Çí‰º∫„Å£„Å¶„ÇÇ„Çà„Çç„Åó„ÅÑ„Åß„Åô„ÅãÔºü", en: "May I have your name, please?", ex: "‰∏ÅÂØß„Å™ÂêçÂâç„ÅÆËÅû„ÅçÊñπ„ÄÇ" }
        ],
        news: [
            { jp: "‰ΩéË≥ÉÈáë„ÇÑÂä¥ÂÉç„ÅÆÈÅéÈÖ∑„Åï„Åã„Çâ‰ªãË≠∑„ÅÆÊãÖ„ÅÑÊâã„Åå‰∏çË∂≥„Åó„Å¶„ÅÑ„Çã„ÄÇ", en: "There is a shortage of caregivers due to low wages and harsh working conditions.", ex: "harsh working conditions „ÅØ„ÄåÈÅéÈÖ∑„Å™Âä¥ÂÉçÁí∞Â¢É„Äç„ÄÇ" },
            { jp: "Âú∞Êñπ„ÅÆ„Ç§„É≥„Éï„É©„ÅåËÄÅÊúΩÂåñ„Åó„Å¶„ÅÑ„Çã„ÄÇ", en: "Infrastructure in rural areas is becoming obsolete and aging.", ex: "obsolete „ÅØ„ÄåÂªÉ„Çå„Åü„ÄÅÊóßÂºè„ÅÆ„Äç„ÄÇ" },
            { jp: "AI„ÅÆÈÄ≤Âåñ„Å´„Çà„Çä„ÄÅ„Ç®„É≥„Ç∏„Éã„Ç¢„ÅÆ„É¨„Ç§„Ç™„Éï„ÇÇÂßã„Åæ„Å£„Å¶„ÅÑ„Çã„ÄÇ", en: "With the advancement of AI, layoffs of engineers have already started.", ex: "layoff „ÅØ„Äå‰∏ÄÊôÇËß£Èõá„Äç„ÄÇ" },
            { jp: "AI„Å´‰ª£Êõø„Åï„Çå„Å™„ÅÑËÅ∑Ê•≠„Å®„Åó„Å¶„Éñ„É´„Éº„Ç´„É©„Éº„ÅÆ‰∫∫Ê∞ó„ÇÇÈ´ò„Åæ„Å£„Å¶„ÅÑ„Çã„ÄÇ", en: "Blue-collar jobs are gaining popularity as professions less likely to be replaced by AI.", ex: "replaced by AI „Åß„ÄåAI„Å´Âèñ„Å£„Å¶‰ª£„Çè„Çâ„Çå„Çã„Äç„ÄÇ" },
            { jp: "Á§æ‰ºö„ÅÆ‰∫åÊ•µÂåñ„ÅØ„ÄÅÊ∞ë‰∏ª‰∏ªÁæ©„Å´ÂØæ„Åô„ÇãÈáçÂ§ß„Å™ËÑÖÂ®Å„Åß„Åô„ÄÇ", en: "The polarization of society has become a significant threat to democracy.", ex: "polarization „ÅØ„ÄåÊ•µÁ´Ø„Å™ÂàÜÊñ≠„ÄÅ‰∫åÊ•µÂåñ„Äç„ÄÇ" },
            { jp: "Â§ö„Åè„ÅÆÂõΩ„ÅåÊ∏©ÂÆ§ÂäπÊûú„Ç¨„Çπ„ÅÆÊéíÂá∫Èáè„ÇíÂâäÊ∏õ„Åô„Çã„Åü„ÇÅ„Å´Ë¶èÂà∂„ÇíÂ∞éÂÖ•„Åó„Åü„ÄÇ", en: "Many countries introduced regulations to curb greenhouse gas emissions.", ex: "curb „ÅØ„ÄåÊäëÂà∂„Åô„Çã„Äç„ÄÇ" },
            { jp: "‰∏ñÁïåÁµåÊ∏à„ÅØ„Ç§„É≥„Éï„É¨„ÅÆÂΩ±Èüø„Åß‰∏çÈÄèÊòé„Å™Áä∂Ê≥Å„ÅåÁ∂ö„ÅÑ„Å¶„ÅÑ„Åæ„Åô„ÄÇ", en: "The global economy remains uncertain due to the impact of inflation.", ex: "uncertain „ÅØ„Äå‰∏çÈÄèÊòé„ÄÅ‰∏çÂÆâÂÆö„Äç„ÄÇ" },
            { jp: "„Åù„ÅÆÊäÄË°ìÈù©Êñ∞„ÅØ„ÄÅÂåªÁôÇ„ÇíÊ†πÂ∫ï„Åã„ÇâÂ§â„Åà„ÇãÂèØËÉΩÊÄß„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ", en: "That innovation has the potential to revolutionize healthcare.", ex: "revolutionize „ÅØ„Äå„Äú„Å´Èù©ÂëΩ„ÇíËµ∑„Åì„Åô„Äç„ÄÇ" },
            { jp: "ÊîøÂ∫ú„ÅØÂ∞ëÂ≠êÈ´òÈΩ¢ÂåñÂØæÁ≠ñ„ÇíÊ§úË®é„Åó„Å¶„ÅÑ„Çã„ÄÇ", en: "The government is considering measures to address the shrinking and aging population.", ex: "address „ÅØ„ÄåÔºàË™≤È°å„Å´ÔºâÂèñ„ÇäÁµÑ„ÇÄ„Äç„ÄÇ" },
            { jp: "ÊåÅÁ∂öÂèØËÉΩ„Å™ÈñãÁô∫ÁõÆÊ®ôÔºàSDGsÔºâ„ÅØ‰∏ñÁïåÂÖ±ÈÄö„ÅÆË™≤È°å„Åß„Åô„ÄÇ", en: "The SDGs are common global issues to be addressed.", ex: "SDGs„ÅØ Sustainable Development Goals „ÅÆÁï•„ÄÇ" },
            { jp: "ÂÜçÁîüÂèØËÉΩ„Ç®„Éç„É´„ÇÆ„Éº„Å∏„ÅÆËª¢Êèõ„ÅåÊÄ•Âãô„Å®„Å™„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇ", en: "Transitioning to renewable energy has become an urgent task.", ex: "urgent task „Åß„ÄåÊÄ•Âãô„Äç„ÄÇ" },
            { jp: "„Éá„Ç∏„Çø„É´Ê†ºÂ∑Æ„ÅåÊñ∞„Åü„Å™Á§æ‰ºöÂïèÈ°å„Å®„Å™„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇ", en: "The digital divide is becoming a new social issue.", ex: "digital divide „ÅØ„ÄåÊÉÖÂ†±„ÅÆÊ†ºÂ∑Æ„Äç„ÄÇ" },
            { jp: "„Åù„ÅÆÂõΩ„ÅØÊ∑±Âàª„Å™ÁµåÊ∏àÂç±Ê©ü„Å´Áõ¥Èù¢„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ", en: "The country is facing a severe economic crisis.", ex: "facing a crisis „Åß„ÄåÂç±Ê©ü„Å´Áõ¥Èù¢„Åô„Çã„Äç„ÄÇ" },
            { jp: "„Éó„É©„Ç§„Éê„Ç∑„Éº‰øùË≠∑„Å®Âà©‰æøÊÄß„ÅÆ„Éê„É©„É≥„Çπ„ÅåÊ±Ç„ÇÅ„Çâ„Çå„Å¶„ÅÑ„Çã„ÄÇ", en: "A balance between privacy protection and convenience is required.", ex: "balance between A and B." },
            { jp: "‰ªÆÊÉ≥ÈÄöË≤®„ÅÆÂ∏ÇÂ†¥„ÅØÈùûÂ∏∏„Å´Â§âÂãï„ÅåÊøÄ„Åó„ÅÑ„Åß„Åô„ÄÇ", en: "The cryptocurrency market is highly volatile.", ex: "volatile „ÅØ„ÄåÂ§âÂãï„Åó„ÇÑ„Åô„ÅÑ„ÄÅ‰∏çÂÆâÂÆö„Å™„Äç„ÄÇ" },
            { jp: "„ÉØ„Éº„ÇØ„É©„Ç§„Éï„Éê„É©„É≥„Çπ„ÅÆÈáçË¶ÅÊÄß„ÅåÂÜçË™çË≠ò„Åï„Çå„Å¶„ÅÑ„Çã„ÄÇ", en: "The importance of work-life balance is being recognized again.", ex: "recognized „ÅØ„ÄåË™çË≠ò„Åï„Çå„Çã„Äç„ÄÇ" },
            { jp: "È£üÊñôËá™Áµ¶Áéá„ÅÆÂêë‰∏ä„ÅåÊ±Ç„ÇÅ„Çâ„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ", en: "Improvement of the food self-sufficiency rate is required.", ex: "food self-sufficiency rate „ÅØ„ÄåÈ£üÊñôËá™Áµ¶Áéá„Äç„ÄÇ" },
            { jp: "„Çµ„Éó„É©„Ç§„ÉÅ„Çß„Éº„É≥„ÅÆÊ∑∑‰π±„ÅåË£ΩÂìÅ‰æ°Ê†º„ÇíÊäº„Åó‰∏ä„Åí„Å¶„ÅÑ„Çã„ÄÇ", en: "Supply chain disruptions are driving up product prices.", ex: "disruptions „ÅØ„ÄåÊ∑∑‰π±„ÄÅ‰∏≠Êñ≠„Äç„ÄÇ" },
            { jp: "ÊúÄ‰ΩéË≥ÉÈáë„ÅÆÂºï„Åç‰∏ä„Åí„ÅåÂÖ®ÂõΩ„ÅßË≠∞Ë´ñ„Åï„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ", en: "Increasing the minimum wage is being discussed nationwide.", ex: "minimum wage „ÅØ„ÄåÊúÄ‰ΩéË≥ÉÈáë„Äç„ÄÇ" },
            { jp: "Â∞ëÂ≠êÂåñ„ÅåÂä¥ÂÉçÂäõ‰∏çË∂≥„Å´ÊãçËªä„Çí„Åã„Åë„Å¶„ÅÑ„Åæ„Åô„ÄÇ", en: "The declining birthrate is accelerating the labor shortage.", ex: "accelerate „Åß„Äå„Äú„Å´ÊãçËªä„Çí„Åã„Åë„Çã/Âä†ÈÄü„Åï„Åõ„Çã„Äç„ÄÇ" }
        ]
    };

    const categoryNames = {
        business: "üíº ËÅ∑Â†¥„Åß„ÅÆ‰ºöË©±",
        meeting: "üåê Web‰ºöË≠∞",
        daily: "üè† Êó•Â∏∏ÁîüÊ¥ª",
        news: "üìà ÊôÇ‰∫ã„Éª„Éà„É¨„É≥„Éâ"
    };

    let currentQueue = [];
    let currentQuestion = null;
    let totalAttempts = 0;
    let correctCount = 0;
    let audioEnabled = false;
    let isAnswerShown = false;
    let isJudged = false;

    const japaneseEl = document.getElementById('japanese-text');
    const englishEl = document.getElementById('english-text');
    const explanationBox = document.getElementById('explanation-box');
    const explanationContent = document.getElementById('explanation-content');
    const statRem = document.getElementById('stat-remaining');
    const statCor = document.getElementById('stat-correct');
    const categoryHeader = document.getElementById('current-category-name');
    
    const btnCorrect = document.getElementById('btn-correct');
    const btnWrong = document.getElementById('btn-wrong');
    const btnNext = document.getElementById('btn-next');
    
    const synth = window.speechSynthesis;

    function startGame(category) {
        document.getElementById('start-overlay').style.display = 'none';
        categoryHeader.innerText = categoryNames[category];
        audioEnabled = true;
        
        currentQueue = [...questionBank[category]].sort(() => Math.random() - 0.5);
        totalAttempts = 0;
        correctCount = 0;
        
        nextQuestion();
    }

    function nextQuestion() {
        if (currentQueue.length === 0) {
            finishGame();
            return;
        }

        currentQuestion = currentQueue[0];
        japaneseEl.innerText = currentQuestion.jp;
        englishEl.innerText = currentQuestion.en;
        explanationContent.innerHTML = currentQuestion.ex || "Ëß£Ë™¨„ÇíÊ∫ñÂÇô‰∏≠...";
        
        englishEl.style.display = 'none';
        explanationBox.style.display = 'none';
        btnCorrect.style.display = 'none';
        btnWrong.style.display = 'none';
        btnNext.style.display = 'none';
        
        isAnswerShown = false;
        isJudged = false;
        
        updateStats();
    }

    function showAnswer() {
        if (isAnswerShown) return;
        
        isAnswerShown = true;
        englishEl.style.display = 'block';
        btnCorrect.style.display = 'block';
        btnWrong.style.display = 'block';
        
        if (audioEnabled) {
            const utter = new SpeechSynthesisUtterance(currentQuestion.en);
            utter.lang = 'en-US';
            utter.rate = 0.9;
            synth.cancel();
            synth.speak(utter);
        }
    }

    function judge(isCorrect) {
        if (isJudged) return;
        isJudged = true;

        totalAttempts++;
        if (isCorrect) {
            correctCount++;
            currentQueue.shift();
        } else {
            const wrongItem = currentQueue.shift();
            currentQueue.push(wrongItem);
        }

        explanationBox.style.display = 'block';
        btnCorrect.style.display = 'none';
        btnWrong.style.display = 'none';
        btnNext.style.display = 'block';
        
        updateStats();
    }

    function updateStats() {
        statRem.innerText = currentQueue.length;
        statCor.innerText = correctCount;
    }

    function finishGame() {
        const resultScreen = document.getElementById('result-screen');
        resultScreen.style.display = 'flex';
        
        const rate = totalAttempts === 0 ? 0 : Math.round((correctCount / totalAttempts) * 100);
        document.getElementById('final-rate').innerText = rate + "%";
        document.getElementById('final-stats').innerText = `ÂõûÁ≠îÊï∞: ${totalAttempts} / Ê≠£Ëß£Êï∞: ${correctCount}`;
    }
</script>
</body>
</html>
